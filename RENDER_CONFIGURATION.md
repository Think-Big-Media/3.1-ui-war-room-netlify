# War Room Platform - Current Render Configuration Documentation

## Overview
This document contains the exact configuration settings from the current production deployment at https://war-room-oa9t.onrender.com. Use this as a reference when setting up the new client environment.

---

## Current Service Configuration

### Web Service Settings
```yaml
Service Name: war-room
Service Type: Web Service
Environment: Python
Region: Oregon (US-West)
Plan: Starter ($7/month)
```

### Build Configuration
```bash
# Build Command (from render.yaml)
Build Command: |
  echo "ðŸš€ Starting War Room Analytics build process..."
  echo "Current directory: $(pwd)"
  echo "Available files:"
  ls -la
  
  # Install backend dependencies
  echo "ðŸ“¦ Installing backend dependencies..."
  cd src/backend && pip install -r requirements.txt
  
  # Install frontend dependencies and build
  echo "ðŸŽ¨ Building frontend application..."
  cd ../frontend
  echo "Frontend directory: $(pwd)"
  ls -la
  
  # Install with legacy peer deps for better compatibility
  npm install --legacy-peer-deps
  
  # Optimize Node.js memory for build
  export NODE_OPTIONS="--max-old-space-size=1024"
  
  # Build frontend for production
  npm run build
  
  # Verify build output
  echo "âœ… Build complete. Checking dist directory:"
  ls -la dist/ || echo "No dist directory found"
  
  echo "ðŸŽ¯ Build process completed successfully!"

# Runtime Configuration
Start Command: cd src/backend && python serve_bulletproof.py
Health Check Path: /health
Auto Deploy: false  # Set to true after initial setup
```

---

## Database Services

### PostgreSQL Configuration
```yaml
Service Name: war-room-db
Database Name: warroom
User: warroom
Region: Oregon
Plan: Starter ($7/month - 256MB, 1M rows, daily backups)
Version: 15
Connection Pooling: Enabled
SSL: Required
```

#### Connection Details (Current)
```bash
# Internal connection (used by application)
DATABASE_URL: postgresql://warroom:[password]@[host]:[port]/warroom

# External connection (for admin access)
External URL: Available in Render dashboard

# Connection Pool Settings
DB_POOL_SIZE: 20
DB_MAX_OVERFLOW: 40
DB_POOL_RECYCLE: 3600 seconds
DB_POOL_PRE_PING: true
DB_POOL_TIMEOUT: 30 seconds
DB_ECHO: false (production setting)
```

### Redis Configuration
```yaml
Service Name: war-room-redis
Region: Oregon
Plan: Starter ($10/month - 25MB with persistence)
Version: 7
Maxmemory Policy: allkeys-lru
Persistence: RDB + AOF (if available)
```

#### Connection Details (Current)
```bash
# Internal connection
REDIS_URL: rediss://default:[password]@[host]:[port]

# Pool Settings
REDIS_POOL_MIN_SIZE: 10
REDIS_POOL_MAX_SIZE: 20
REDIS_MAX_CONNECTIONS: 50
```

---

## Environment Groups

### Core Application Variables
```bash
# Runtime Configuration
PYTHON_VERSION=3.11.0
NODE_VERSION=18.17.0
RENDER_ENV=production
APP_NAME="War Room Analytics"
APP_VERSION=1.0.0
ENVIRONMENT=production
DEBUG=false
LOG_LEVEL=INFO
API_V1_STR=/api/v1

# Security Configuration (Auto-generated by Render)
SECRET_KEY=[GENERATED_BY_RENDER]
JWT_SECRET=[GENERATED_BY_RENDER]
JWT_ALGORITHM=HS256
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30
REFRESH_TOKEN_EXPIRE_DAYS=7
```

### Database Configuration
```bash
# Database URLs (Auto-populated by Render)
DATABASE_URL=${war-room-db.connectionString}
REDIS_URL=${war-room-redis.connectionString}

# Database Pool Settings
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=40
DB_POOL_RECYCLE=3600
DB_POOL_PRE_PING=true
DB_POOL_TIMEOUT=30
DB_ECHO=false
```

### CORS and API Configuration
```bash
# Update these URLs for new deployment
BACKEND_CORS_ORIGINS=https://war-room-oa9t.onrender.com,https://war-room.onrender.com
VITE_API_URL=https://war-room-oa9t.onrender.com
VITE_API_BASE_URL=https://war-room-oa9t.onrender.com
API_BASE_URL=https://war-room-oa9t.onrender.com

CORS_ALLOW_CREDENTIALS=true
CORS_MAX_AGE=86400
```

### Feature Flags
```bash
# Backend Features
ENABLE_ANALYTICS=true
ENABLE_AUTOMATION=true
ENABLE_DOCUMENT_INTELLIGENCE=false
ENABLE_REAL_TIME_UPDATES=true
ENABLE_EXPORT_FEATURE=true
ENABLE_ADVANCED_ANALYTICS=true

# Frontend Features
VITE_ENV=production
VITE_ENABLE_ANALYTICS=true
VITE_ENABLE_AUTOMATION=true
VITE_ENABLE_DOCUMENT_INTELLIGENCE=false
VITE_ENABLE_GOOGLE_AUTH=false
VITE_ENABLE_GITHUB_AUTH=false
VITE_FORCE_MOCK_MODE=false

# Legacy React App Support
REACT_APP_ENV=production
REACT_APP_ENABLE_ANALYTICS=true
REACT_APP_ENABLE_AUTOMATION=true
REACT_APP_ENABLE_DOCUMENT_INTELLIGENCE=false
REACT_APP_DEFAULT_ORG_ID=""
```

### WebSocket Configuration
```bash
WS_HEARTBEAT_INTERVAL=30
WS_MESSAGE_QUEUE_SIZE=100
WS_CONNECTION_TIMEOUT=60
ANALYTICS_UPDATE_INTERVAL=5
```

---

## External Service Integrations

### Supabase Configuration (Current)
```bash
# Replace these with client's Supabase project
VITE_SUPABASE_URL=[CURRENT_SUPABASE_URL]
VITE_SUPABASE_ANON_KEY=[CURRENT_SUPABASE_ANON_KEY]
REACT_APP_SUPABASE_URL=[CURRENT_SUPABASE_URL]
REACT_APP_SUPABASE_ANON_KEY=[CURRENT_SUPABASE_ANON_KEY]
```

### PostHog Analytics (Current)
```bash
# Replace with client's PostHog project
POSTHOG_KEY=[CURRENT_POSTHOG_KEY]
POSTHOG_HOST=https://app.posthog.com
POSTHOG_ENABLED=true
POSTHOG_API_KEY=[CURRENT_POSTHOG_API_KEY]
POSTHOG_PERSON_PROFILES=identified_only
VITE_POSTHOG_KEY=[CURRENT_POSTHOG_KEY]
VITE_POSTHOG_HOST=https://app.posthog.com
```

### Sentry Error Tracking (Current)
```bash
# Replace with client's Sentry project
SENTRY_DSN=[CURRENT_SENTRY_DSN]
SENTRY_ENVIRONMENT=production
SENTRY_TRACES_SAMPLE_RATE=0.1
SENTRY_PROFILES_SAMPLE_RATE=0.1
```

---

## Performance and Monitoring

### Rate Limiting Configuration
```bash
RATE_LIMIT_ANALYTICS=30/minute
RATE_LIMIT_EXPORT=10/hour
RATE_LIMIT_WEBSOCKET=100/minute
```

### Export Settings
```bash
MAX_EXPORT_ROWS=10000
EXPORT_TIMEOUT=300
PDF_GENERATION_TIMEOUT=60
```

### Performance Optimizations
```bash
MAX_CHART_DATA_POINTS=10000
AGGREGATION_THRESHOLD=1000
```

### Health Monitoring
```bash
HEALTH_CHECK_ENABLED=true
ENABLE_METRICS=true
LOG_FORMAT=json
```

---

## Network and Security

### SSL Configuration
```bash
# Automatically provided by Render
SSL Certificate: Auto-generated and managed
Certificate Type: Let's Encrypt
Auto-renewal: Enabled
HTTPS Redirect: Enabled
HSTS: Enabled
```

### Security Headers
```bash
# Implemented in application code
Content Security Policy: Configured
X-Frame-Options: DENY
X-Content-Type-Options: nosniff
Referrer-Policy: strict-origin-when-cross-origin
```

### Network Security
```bash
# Render platform security
DDoS Protection: Enabled
IP Whitelisting: Not configured (open to public)
Geographic Restrictions: None
```

---

## Scaling Configuration

### Current Resource Allocation
```yaml
Plan: Starter
vCPU: 0.5
Memory: 512 MB
Disk: Ephemeral (build artifacts only)
Persistent Disk: 1 GB (mounted at /opt/render/project/src/backend/storage)
```

### Auto-scaling Settings
```yaml
Min Instances: 1
Max Instances: 1 (Starter plan limitation)
Health Check Grace Period: 300 seconds
Health Check Interval: 30 seconds
Health Check Path: /health
Health Check Timeout: 10 seconds
```

### Load Balancer Configuration
```yaml
# Managed by Render
Load Balancer: Built-in
Session Affinity: Disabled
Connection Timeout: 30 seconds
Request Timeout: 30 seconds
```

---

## Deployment Configuration

### Git Integration
```yaml
Repository: Connected to GitHub
Branch: main
Auto Deploy: false (currently disabled)
Deploy Hook: Not configured
Build Cache: Enabled
```

### Build Environment
```bash
# Build-time environment variables
NODE_ENV=production
PYTHON_ENV=production
BUILD_OPTIMIZATION=true

# Node.js build optimization
NODE_OPTIONS=--max-old-space-size=1024
```

### Deploy Settings
```yaml
Deploy Timeout: 15 minutes
Zero Downtime Deploys: Enabled (Starter plan)
Deploy Notifications: Not configured
Pre-deploy Commands: None
Post-deploy Commands: None
```

---

## Monitoring and Logging

### Built-in Monitoring
```yaml
# Available in Render Dashboard
CPU Usage: Tracked
Memory Usage: Tracked
Response Times: Tracked
Error Rates: Tracked
Request Volume: Tracked
```

### Log Configuration
```bash
# Log management
Log Level: INFO
Log Format: JSON
Log Retention: 7 days (Starter plan)
Log Streaming: Available via dashboard
```

### Health Checks
```yaml
Health Check URL: /health
Expected Status Code: 200
Check Interval: 30 seconds
Failure Threshold: 3 consecutive failures
Success Threshold: 1 success after failure
```

---

## Backup and Recovery

### Database Backups
```yaml
PostgreSQL Backups:
  Schedule: Daily automatic backups
  Retention: 7 days (Starter plan)
  Type: Full database backup
  Encryption: Enabled
  Point-in-time Recovery: Available
```

### Redis Persistence
```yaml
Redis Backup:
  RDB Snapshots: Enabled
  AOF Logging: Enabled (if available)
  Backup Schedule: Automatic
  Data Durability: Guaranteed
```

### Application Data
```bash
# Persistent disk backup
Disk Snapshots: Manual only
Application Files: Backed up with code deployment
Configuration: Stored in environment variables
```

---

## Migration-Specific Notes

### Environment Variable Updates Required
```bash
# These MUST be updated for new deployment:
BACKEND_CORS_ORIGINS: Update with new domain
VITE_API_URL: Update with new domain
VITE_API_BASE_URL: Update with new domain
API_BASE_URL: Update with new domain

# These MUST be replaced with client's services:
VITE_SUPABASE_URL: Client's Supabase project
VITE_SUPABASE_ANON_KEY: Client's Supabase key
POSTHOG_KEY: Client's PostHog project
SENTRY_DSN: Client's Sentry project
```

### Security Considerations
```bash
# These will be auto-generated by Render in new environment:
SECRET_KEY: New random value
JWT_SECRET: New random value

# Database connections will be automatically configured:
DATABASE_URL: New PostgreSQL service connection
REDIS_URL: New Redis service connection
```

### Service Dependencies
```bash
# Required for full functionality:
1. PostgreSQL database (war-room-db)
2. Redis cache (war-room-redis)
3. Supabase project (client-provided)
4. PostHog project (client-provided)
5. Sentry project (client-provided)
6. Custom domain (optional but recommended)
```

---

## Recommended Changes for New Deployment

### Performance Improvements
```yaml
# Consider upgrading plans for production:
Web Service: Standard plan ($25/month) for better performance
PostgreSQL: Standard plan ($25/month) for more storage
Redis: Standard plan ($25/month) for more memory
```

### Security Enhancements
```bash
# Additional security measures to consider:
1. Enable IP whitelisting for admin endpoints
2. Configure additional security headers
3. Set up WAF rules for common attacks
4. Enable advanced monitoring and alerting
```

### Operational Improvements
```bash
# Operational enhancements:
1. Enable auto-deploy after testing
2. Set up deploy notifications
3. Configure monitoring alerts
4. Set up backup monitoring
5. Enable performance profiling
```

---

## Configuration Export Command

To export the current configuration from Render dashboard:

```bash
# Use Render CLI (if available)
render config export --service war-room

# Or manually document from dashboard:
# 1. Go to Service Settings
# 2. Copy Environment Variables
# 3. Note all configuration settings
# 4. Document any custom configurations
```

---

## Troubleshooting Configuration Issues

### Common Build Issues
```bash
# Memory issues during build
Solution: Increase NODE_OPTIONS memory limit
Current: NODE_OPTIONS="--max-old-space-size=1024"

# npm install failures
Solution: Use --legacy-peer-deps flag
Current: npm install --legacy-peer-deps

# Python dependency issues
Solution: Check requirements.txt and Python version
Current: Python 3.11.0
```

### Runtime Configuration Issues
```bash
# Database connection failures
Check: DATABASE_URL format and credentials
Verify: Database service is running

# Redis connection failures
Check: REDIS_URL format and credentials
Verify: Redis service is running

# CORS errors
Check: BACKEND_CORS_ORIGINS includes your domain
Verify: Domain matches exactly (including https://)
```

---

**Important Notes:**
1. All sensitive values are redacted in this documentation
2. Real credentials will be provided separately during migration
3. Configuration should be reviewed and updated for the new environment
4. Test all settings thoroughly before going live
5. Monitor performance and adjust settings as needed

**Last Updated**: [CURRENT_DATE]  
**Current Deployment**: https://war-room-oa9t.onrender.com  
**Next Review**: After migration completion